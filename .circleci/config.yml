version: 2.1

orbs:
  node: circleci/node@4.1

jobs:
  lint-and-test:
    executor:
      name: node/default
      tag: << parameters.version >>
    parameters:
      version:
        type: string
    steps:
      - checkout
      - node/install:
          install-yarn: true
          install-npm: false
          node-version: << parameters.version >>
      - node/install-packages:
          pkg-manager: yarn
      - run:
          name: Lint
          command: yarn lint
      - run:
          name: Test
          command: yarn test:ci
workflows:
  ci-build:
    jobs:
      - lint-and-test:
          matrix:
            parameters:
              version: ['12.22.6', '14.17.6', '16.8.0']
